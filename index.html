<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FreshPoroto | Carta Digital</title>
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="styles.css">

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
</head>
<body>

    <div id="auth-modal" class="full-screen-overlay">
        <div class="auth-card">
            <div class="close-modal" onclick="closeAuthModal()">&times;</div>
            <div class="logo-text">Fresh<span>Poroto</span></div>
            <p style="color:#888; margin-bottom: 20px;">Acceso Clientes</p>
            
            <div id="auth-msg" class="status-msg"></div>

            <div class="auth-tabs">
                <div class="tab active" onclick="switchAuth('login')">Ingresar</div>
                <div class="tab" onclick="switchAuth('register')">Crear Cuenta</div>
            </div>
            
            <div id="form-login" class="form-view active">
                <input type="email" id="login-email" class="input-box" placeholder="Usuario / Correo">
                <input type="password" id="login-pass" class="input-box" placeholder="Contraseña">
                <button class="btn-action" onclick="login()">Entrar</button>
                <p style="margin-top:15px; font-size:0.8rem; color:#777; cursor:pointer; text-decoration:underline;" onclick="switchAuth('recovery')">¿Olvidaste tu contraseña?</p>
            </div>
            
            <div id="form-register" class="form-view">
                <input type="text" id="reg-name" class="input-box" placeholder="Nombre">
                <input type="email" id="reg-email" class="input-box" placeholder="Correo">
                <input type="password" id="reg-pass" class="input-box" placeholder="Crear Contraseña">
                <button class="btn-action" onclick="register()">Registrarse</button>
            </div>

            <div id="form-recovery" class="form-view">
                <h3 style="color:var(--dark); margin-bottom:10px;">Recuperar Clave</h3>
                <p style="font-size:0.9rem; color:#666; margin-bottom:15px;">Ingresa tu correo y te enviaremos las instrucciones.</p>
                <input type="email" id="rec-email" class="input-box" placeholder="tucorreo@ejemplo.com">
                <button class="btn-action" onclick="recoverPassword()">Enviar Correo</button>
                <p style="margin-top:15px; font-size:0.8rem; color:var(--primary); cursor:pointer;" onclick="switchAuth('login')">Volver al Login</p>
            </div>
        </div>
    </div>

    <div id="app-view">
        <div class="mobile-header">
            <div class="hamburger" onclick="toggleSidebar()"><i class="fas fa-bars"></i></div>
            <div class="logo-text" style="font-size:1.2rem;">Fresh<span>Poroto</span></div>
            <div onclick="showSection('orders', null)" style="position:relative;">
                <i class="fas fa-shopping-bag"></i>
                <span id="mobile-cart-count" style="position:absolute; top:-5px; right:-8px; background:var(--accent); color:white; font-size:0.6rem; padding:2px 5px; border-radius:10px;">0</span>
            </div>
        </div>
        <div class="sidebar-overlay" onclick="toggleSidebar()"></div>

        <aside class="sidebar">
            <div class="logo-text" style="font-size:1.5rem; margin-bottom:20px;"><i class="fas fa-leaf"></i> Fresh<span>Poroto</span></div>
            <div class="nav-menu">
                <div class="nav-link active" onclick="showSection('about', this)"><i class="fas fa-info-circle"></i> Nuestra Historia</div>
                <div class="nav-link" onclick="showSection('menu', this)"><i class="fas fa-utensils"></i> Carta</div>
                <div class="nav-link" onclick="showSection('orders', this)"><i class="fas fa-receipt"></i> Mis Pedidos</div>
               
                <div class="nav-link mobile-login-btn" onclick="openAuthModal()" style="color:var(--primary); margin-top:20px; font-weight:700;"><i class="fas fa-user"></i> Iniciar Sesión</div>
            </div>
            
            <div id="sidebar-user-info">
                <div style="width:40px; height:40px; background:#333; color:white; border-radius:50%; display:flex; justify-content:center; align-items:center;" id="avatar">U</div>
                <div>
                    <div style="font-weight:bold;" id="username-display">Usuario</div>
                    <div style="font-size:0.8rem; color:#888; cursor:pointer;" onclick="logout()">Cerrar Sesión</div>
                </div>
            </div>
        </aside>

        <div class="main-container">
            
            <div class="top-user-panel" id="top-auth-panel">
                <div class="auth-btn-top" onclick="openAuthModal()">Iniciar Sesión</div>
                <div class="auth-btn-top highlight" onclick="openAuthModal('register')">Registrarse</div>
            </div>

            <div id="section-about">
                <div class="hero-banner">
                    <h1>Sabor con Historia</h1>
                    <p>La tradición de la cocina chilena, directamente en tu mesa.</p>
                </div>

                <div class="about-card">
                    <h2 style="color:var(--primary); margin-bottom:20px;">Nuestra Historia</h2>
                    <div class="story-text">
                        <p>Hace más de una década, en una pequeña cocina en el corazón de Santiago, nació <b>FreshPoroto</b>. Todo comenzó con una receta familiar de "Porotos con Riendas" que la abuela Elena preparaba cada domingo. El aroma era tan irresistible que los vecinos comenzaron a pedir platos para llevar.</p>
                        <p>Lo que empezó como un secreto vecinal pronto se transformó en una misión: <b>recuperar el valor de la comida casera</b> en un mundo que corre demasiado rápido. Nos dimos cuenta de que las oficinas estaban llenas de opciones rápidas pero vacías de cariño.</p>
                        <p>Hoy, FreshPoroto combina esa tradición con la tecnología. Mantenemos las ollas de greda y los ingredientes frescos del mercado local, pero te lo llevamos con la eficiencia que tu día laboral necesita. No somos solo un delivery; somos tu pausa de calidez en medio de la jornada.</p>
                    </div>
                    
                    <div class="about-features">
                        <div class="feat-box"><i class="fas fa-leaf"></i><h3>100% Fresco</h3><p style="font-size:0.9rem; color:#777;">Selección diaria de mercado.</p></div>
                        <div class="feat-box"><i class="fas fa-heart"></i><h3>Receta Abuela</h3><p style="font-size:0.9rem; color:#777;">Sazón auténtica garantizada.</p></div>
                        <div class="feat-box"><i class="fas fa-truck-fast"></i><h3>Puntualidad</h3><p style="font-size:0.9rem; color:#777;">Tu tiempo es oro.</p></div>
                    </div>

                    <div class="contact-info">
                        <h3 style="margin-bottom:20px;">Contacto & Horarios</h3>
                        <div class="contact-item"><i class="fas fa-map-marker-alt" style="color:var(--accent);"></i> <span>Av. Gastronomía 123, Providencia, Santiago.</span></div>
                        <div class="contact-item"><i class="fas fa-phone" style="color:var(--primary);"></i> <span>+56 9 9876 5432</span></div>
                        <div class="contact-item"><i class="fas fa-envelope" style="color:var(--dark);"></i> <span>contacto@freshporoto.cl</span></div>
                        <div class="contact-item"><i class="fas fa-clock" style="color:#f39c12;"></i> <span>Lun-Vie: 11:00 - 16:00 | Sáb: 12:00 - 15:00</span></div>
                    </div>
                    <button class="btn-action" style="margin-top:30px; width:auto; padding:15px 40px;" onclick="goToMenu()">Ir a la Carta</button>
                </div>

                <div class="complaints-section">
                    <h2 style="color: var(--accent); margin-bottom: 20px;">¿Algo que contarnos?</h2>
                    <p style="color: #666; margin-bottom: 20px;">Tus comentarios nos ayudan a mejorar. Déjanos tus sugerencias o reclamos.</p>
                    <form onsubmit="event.preventDefault(); showToast('¡Gracias! Hemos recibido tu mensaje.'); this.reset();">
                        <input type="text" class="input-box" placeholder="Tu Nombre" required style="background-color: #F4F6F7;">
                        <input type="email" class="input-box" placeholder="Tu Correo" required style="background-color: #F4F6F7;">
                        <textarea class="input-box" rows="4" placeholder="Escribe tu mensaje aquí..." required style="resize: none; font-family: inherit; background-color: #F4F6F7;"></textarea>
                        <button class="btn-action" style="background-color: var(--dark); width: auto; padding: 10px 30px;">Enviar Mensaje</button>
                    </form>
                </div>
            </div>

            <div id="section-menu" style="display:none;">
                <h1 style="margin-bottom:10px;">Nuestra Carta</h1>
                <p style="color:#777; margin-bottom:30px;">Explora nuestra variedad de sabores caseros.</p>
                <div id="menu-container"></div>
            </div>

            <div id="section-orders" style="display:none;">
                <h1 style="margin-bottom:20px;">Tu Bandeja</h1>
                <div id="orders-list"></div>
                
                <div id="cart-actions" style="display:none;">
                    <div class="delivery-options" style="display:block;">
                        <h3 style="margin-bottom:15px;">Tipo de Entrega</h3>
                        <div class="delivery-toggle">
                            <div class="toggle-btn active" onclick="setDeliveryMode('pickup', this)">Retiro en Local</div>
                            <div class="toggle-btn" onclick="setDeliveryMode('delivery', this)">Delivery (+$2.000)</div>
                        </div>
                        
                        <div id="delivery-form" style="display:none; animation:fadeIn 0.3s;">
                            <label style="display:block; margin-bottom:5px; font-weight:600;">Dirección de Envío:</label>
                            <input type="text" id="user-address" class="input-box" placeholder="Ej: Av. Providencia 1234, Of. 505">
                            
                            <label style="display:block; margin-bottom:5px; font-weight:600; margin-top:10px;">Teléfono de Contacto:</label>
                            <input type="tel" id="user-phone" class="input-box" placeholder="+56 9 1234 5678">
                        </div>
                    </div>

                    <div id="total-bar" style="background:var(--dark); color:white; padding:20px; border-radius:15px; margin-top:20px; display:block;">
                        <div class="summary-row" style="color:#ccc;">
                            <span>Subtotal:</span>
                            <span id="subtotal-price">$0</span>
                        </div>
                        <div class="summary-row" style="color:#ccc;" id="delivery-fee-row">
                            <span>Envío Delivery:</span>
                            <span>$2.000</span>
                        </div>
                        <div class="total-row">
                            <span>Total a Pagar:</span>
                            <span id="total-price">$0</span>
                        </div>
                    </div>
                    
                    <button id="btn-confirm" class="btn-action" style="margin-top:20px; background:var(--accent);" onclick="processOrder()">
                        <i class="fas fa-check-circle"></i> Confirmar Pedido
                    </button>
                </div>
            </div>

        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>